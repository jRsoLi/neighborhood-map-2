var Sight=function(e,i,t,n){function o(e){var i=new google.maps.MarkerImage("http://chart.googleapis.com/chart?chst=d_map_spin&chld=1.15|0|"+e+"|40|_|%E2%80%A2",new google.maps.Size(21,34),new google.maps.Point(0,0),new google.maps.Point(10,34),new google.maps.Size(21,34));return i}var s=this;this.title=e,this.lat=i,this.lng=t,this.id=n,this.infowindow=new google.maps.InfoWindow;var a=o("225FC1"),r=o("FC0505");this.marker=new google.maps.Marker({position:new google.maps.LatLng(s.lat,s.lng),map:map,title:s.title,animation:google.maps.Animation.DROP,icon:a}),this.openInfowindow=function(){for(var e=0;e<sightsModel.sights.length;e++)sightsModel.sights[e].infowindow.close();map.panTo(s.marker.getPosition()),s.marker.setAnimation(google.maps.Animation.DROP);var i="description",t="http://en.wikipedia.org/w/api.php?action=opensearch&search="+s.marker.title+"&format=json&callback=wikiCallback";$.ajax({url:t,dataType:"jsonp",async:!1,success:function(e){i=e[2][0],s.infowindow.setContent("<div><h3>"+s.marker.title+"</h3><p>"+i+"</p></div>")}}),s.infowindow.open(map,s.marker)},this.marker.addListener("mouseover",function(){this.setIcon(r)}),this.marker.addListener("mouseout",function(){this.setIcon(a)}),this.addListener=google.maps.event.addListener(s.marker,"click",this.openInfowindow)},sightsModel={sights:[new Sight("Speicherstadt",53.544705,9.9749689,"1"),new Sight("Elbphilharmonie",53.5413306,9.9841274,"2"),new Sight("Fischmarkt",53.5451634,9.9532352,"3"),new Sight("Planten un Blomen",53.5495481,9.9797395,"4"),new Sight("Aussen-Alster",53.5674892,10.0056724,"5")],query:ko.observable("")};sightsModel.search=ko.dependentObservable(function(){var e=this,i=this.query().toLowerCase();return ko.utils.arrayFilter(e.sights,function(e){return e.title.toLowerCase().indexOf(i)>=0})},sightsModel),ko.applyBindings(sightsModel);
