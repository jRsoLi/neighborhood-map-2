function initMap(){var e={zoom:14,center:new google.maps.LatLng(53.550022,9.98556),disableDefaultUI:!0};map=new google.maps.Map(document.getElementById("map-canvas"),e);var t=function(e,t,n,i){function a(e){return new google.maps.MarkerImage("http://chart.googleapis.com/chart?chst=d_map_spin&chld=1.15|0|"+e+"|40|_|%E2%80%A2",new google.maps.Size(21,34),new google.maps.Point(0,0),new google.maps.Point(10,34),new google.maps.Size(21,34))}var r=this;this.title=e,this.lat=t,this.lng=n,this.id=i,this.infowindow=new google.maps.InfoWindow;var s=a("225FC1"),l=a("FC0505");this.marker=new google.maps.Marker({position:new google.maps.LatLng(r.lat,r.lng),map:map,title:r.title,animation:google.maps.Animation.DROP,icon:s}),markerArray.push(this.marker),this.openInfowindow=function(){for(var e=0;e<o.sights.length;e++)o.sights[e].infowindow.close();map.panTo(r.marker.getPosition()),r.marker.setAnimation(google.maps.Animation.DROP);var t="description",n="http://en.wikipedia.org/w/api.php?action=opensearch&search="+r.marker.title+"&format=json&callback=wikiCallback",i=setTimeout(function(){alert("failed to get wikipedia resources")},1e3);$.ajax({url:n,dataType:"jsonp",success:function(e){t=e[2][0],r.infowindow.setContent("<div><h3>"+r.marker.title+"</h3><p>"+t+"</p></div>"),clearTimeout(i)}}),r.infowindow.open(map,r.marker)},this.marker.addListener("mouseover",function(){this.setIcon(l)}),this.marker.addListener("mouseout",function(){this.setIcon(s)}),this.addListener=google.maps.event.addListener(r.marker,"click",this.openInfowindow)},o={sights:[new t("Speicherstadt",53.544705,9.9749689,"1"),new t("Elbphilharmonie",53.5413306,9.9841274,"2"),new t("Fischmarkt",53.5451634,9.9532352,"3"),new t("Planten un Blomen",53.5495481,9.9797395,"4"),new t("Aussen-Alster",53.5674892,10.0056724,"5")],query:ko.observable("")};o.search=ko.computed(function(){var e=this,t=this.query().toLowerCase();return ko.utils.arrayFilter(e.sights,function(e){return e.title.toLowerCase().indexOf(t)>=0})},o),o.filteredMarkers=ko.computed(function(){var e=this.query().toLowerCase();return ko.utils.arrayFilter(markerArray(),function(t){return t.title.toLowerCase().indexOf(e)>=0?t.setVisible(!0):t.setVisible(!1)})},o),ko.applyBindings(o)}function gError(){document.getElementById("map-canvas").innerHTML="<h2> Could not find the map you are looking for... </h2>"}var map,markerArray=ko.observableArray([]);
